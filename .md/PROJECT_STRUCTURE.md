# FreeSewing Pipeline ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ 

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦
FreeSewingã‚’ã‚¨ãƒ³ã‚¸ãƒ³ã¨ã—ã¦ä½¿ç”¨ã—ã€å¤§é‡ã®å‹ç´™ã‚’è‡ªå‹•ç”Ÿæˆã™ã‚‹ãŸã‚ã®ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ ã€‚

---

## ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

```
freesewing-pipeline/
â”œâ”€â”€ data/                          # ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ï¼ˆè¾æ›¸ï¼‰
â”‚   â”œâ”€â”€ bodyMaster.v1.json        # ä½“å‹ãƒã‚¹ã‚¿ï¼ˆæ¨™æº–ãƒŒãƒ¼ãƒ‰å¯¸æ³•ï¼‰
â”‚   â”œâ”€â”€ bodyShapeMaster.v1.json   # éª¨æ ¼ãƒ»å§¿å‹¢ãƒã‚¹ã‚¿ï¼ˆè£œæ­£å€¤ï¼‰
â”‚   â”œâ”€â”€ blockMaster.v1.json        # åŸå‹ãƒ»ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚¹ã‚¿
â”‚   â”œâ”€â”€ patternMaster.core.v1.json # ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒã‚¹ã‚¿ï¼ˆä¸€è»ï¼‰
â”‚   â””â”€â”€ mapping.simon.v1.json      # Simonãƒ‘ã‚¿ãƒ¼ãƒ³ç”¨ãƒãƒƒãƒ”ãƒ³ã‚°
â”‚
â”œâ”€â”€ Docs/                          # è¾æ›¸ãƒ»ä»•æ§˜æ›¸
â”‚   â”œâ”€â”€ FeatureMaster v1.md        # å‹ç´™ç‰¹å¾´é‡è¾æ›¸ï¼ˆgarment measuresï¼‰
â”‚   â””â”€â”€ MeasurementMaster v1.md    # äººä½“æ¡å¯¸é …ç›®è¾æ›¸
â”‚
â”œâ”€â”€ .md/                           # è¨­è¨ˆãƒ»è¨ˆç”»ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ 00_system-design.md        # ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆå›³
â”‚   â”œâ”€â”€ 01_implementation-plan.md   # å®Ÿè£…è¨ˆç”»
â”‚   â”œâ”€â”€ FSProtover.md              # FreeSewingãƒãƒ¼ã‚¸ãƒ§ãƒ³æ–¹é‡
â”‚   â”œâ”€â”€ SampleMeta.md              # SampleMetaä»•æ§˜
â”‚   â”œâ”€â”€ Success criteria.md        # æˆåŠŸåˆ¤å®šåŸºæº–
â”‚   â””â”€â”€ ... (ãã®ä»–ã®è¨­è¨ˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ)
â”‚
â”œâ”€â”€ src/                           # ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰
â”‚   â”œâ”€â”€ domain/                    # ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ï¼ˆFreeSewingéä¾å­˜ï¼‰
â”‚   â”‚   â”œâ”€â”€ types.ts               # ãƒ‰ãƒ¡ã‚¤ãƒ³å‹å®šç¾©
â”‚   â”‚   â”œâ”€â”€ measurementBuilder.ts  # æ¸¬å®šå€¤ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«æ§‹ç¯‰
â”‚   â”‚   â””â”€â”€ sampleMeta.ts          # SampleMetaç”Ÿæˆ
â”‚   â”‚
â”‚   â”œâ”€â”€ freesewing/                # ã‚¢ãƒ€ãƒ—ã‚¿å±¤ï¼ˆFreeSewingä¾å­˜ï¼‰
â”‚   â”‚   â”œâ”€â”€ draftSimon.ts          # Simonãƒ‘ã‚¿ãƒ¼ãƒ³ç”Ÿæˆï¼ˆæ¨™æº–ï¼‰
â”‚   â”‚   â”œâ”€â”€ draftSimonNekose.ts   # Simonãƒ‘ã‚¿ãƒ¼ãƒ³ç”Ÿæˆï¼ˆçŒ«èƒŒè£œæ­£ï¼‰
â”‚   â”‚   â”œâ”€â”€ draftSimonGrid.ts      # Simonãƒ‘ã‚¿ãƒ¼ãƒ³ç”Ÿæˆï¼ˆã‚°ãƒªãƒƒãƒ‰ï¼‰
â”‚   â”‚   â””â”€â”€ generateSimonGrid.ts   # ã‚°ãƒªãƒƒãƒ‰ç”Ÿæˆãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”‚   â”‚
â”‚   â”œâ”€â”€ tools/                     # ãƒ„ãƒ¼ãƒ«ãƒ»ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”‚   â”‚   â”œâ”€â”€ extractFromSvg.ts      # SVGã‹ã‚‰ã®ç‰¹å¾´é‡æŠ½å‡º
â”‚   â”‚   â””â”€â”€ introspectSvg.ts       # SVGæ§‹é€ è§£æ
â”‚   â”‚
â”‚   â””â”€â”€ types/                     # å‹å®šç¾©
â”‚       â””â”€â”€ freesewing.d.ts        # FreeSewing v3å‹å®šç¾©
â”‚
â”œâ”€â”€ output/                        # ç”Ÿæˆã•ã‚ŒãŸå‹ç´™ãƒ‡ãƒ¼ã‚¿
â”‚   â”œâ”€â”€ *.svg                      # SVGå‹ç´™ãƒ•ã‚¡ã‚¤ãƒ«
â”‚   â””â”€â”€ *.meta.json                # ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«
â”‚
â”œâ”€â”€ dist/                          # ãƒ“ãƒ«ãƒ‰å‡ºåŠ›ï¼ˆTypeScript â†’ JavaScriptï¼‰
â”œâ”€â”€ node_modules/                  # ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸
â”œâ”€â”€ package.json                   # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨­å®šãƒ»ä¾å­˜é–¢ä¿‚
â”œâ”€â”€ tsconfig.json                  # TypeScriptè¨­å®š
â””â”€â”€ package-lock.json              # ä¾å­˜é–¢ä¿‚ãƒ­ãƒƒã‚¯ãƒ•ã‚¡ã‚¤ãƒ«
```

---

## ä¸»è¦ãƒ•ã‚¡ã‚¤ãƒ«ã®å½¹å‰²

### ãƒ‡ãƒ¼ã‚¿å±¤ï¼ˆ`data/`ï¼‰

#### `bodyMaster.v1.json`
- **å½¹å‰²**: ä½“å‹ãƒã‚¹ã‚¿ï¼ˆæ¨™æº–ãƒŒãƒ¼ãƒ‰å¯¸æ³•ã®è¾æ›¸ï¼‰
- **å†…å®¹**: å¹´é½¢ãƒ»æ€§åˆ¥ãƒ»ã‚µã‚¤ã‚ºä½“ç³»ã”ã¨ã®æ¨™æº–ä½“å‹ãƒ‡ãƒ¼ã‚¿
- **ä¾‹**: `BODY_MEN_20_MID_JIS_M`ï¼ˆãƒ¡ãƒ³ã‚º 20ä»£ ä¸­è‚‰ä¸­èƒŒ JIS Mç›¸å½“ï¼‰
- **ä¸»è¦ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰**: `stature_cm`, `chest_cm`, `waist_cm`, `hips_cm`, `shoulder_to_shoulder_cm`ãªã©

#### `bodyShapeMaster.v1.json`
- **å½¹å‰²**: éª¨æ ¼ãƒ»å§¿å‹¢ãƒã‚¹ã‚¿ï¼ˆè£œæ­£å€¤ã®è¾æ›¸ï¼‰
- **å†…å®¹**: çŒ«èƒŒãƒ»ãƒãƒˆãƒ ãƒãƒ»æ€’è‚©ãƒ»ãªã§è‚©ãªã©ã®éª¨æ ¼è£œæ­£ãƒ‡ãƒ¼ã‚¿
- **ä¾‹**: `SHAPE_NEKOSE`ï¼ˆçŒ«èƒŒï¼‰
- **ä¸»è¦ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰**: `delta_shoulderSlope_deg`, `delta_hpsToWaistFront_cm`ãªã©

#### `blockMaster.v1.json`
- **å½¹å‰²**: åŸå‹ãƒ»ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚¹ã‚¿
- **å†…å®¹**: FreeSewingã®blockï¼ˆbrian/bella/titanãªã©ï¼‰ã¨å†…éƒ¨block_idã®å¯¾å¿œ
- **ä¾‹**: `BLOCK_SHIRT_MEN_BRIAN_BASE`

#### `patternMaster.core.v1.json`
- **å½¹å‰²**: ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒã‚¹ã‚¿ï¼ˆä¸€è»ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼‰
- **å†…å®¹**: ãƒ‘ã‚¿ãƒ¼ãƒ³IDã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆbody_idã€block_id_mainã®å¯¾å¿œ
- **ä¾‹**: `PATTERN_SIMON_MEN_SHIRT`

#### `mapping.simon.v1.json`
- **å½¹å‰²**: Simonãƒ‘ã‚¿ãƒ¼ãƒ³ç”¨ãƒãƒƒãƒ”ãƒ³ã‚°
- **å†…å®¹**: BodyMasterã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¨FreeSewing measurementsã®å¯¾å¿œ

---

### ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå±¤ï¼ˆ`Docs/`, `.md/`ï¼‰

#### `Docs/FeatureMaster v1.md`
- **å½¹å‰²**: å‹ç´™ç‰¹å¾´é‡è¾æ›¸
- **å†…å®¹**: `SampleMeta.features.garment_measures`ã®ã‚­ãƒ¼å®šç¾©
- **ä¸»è¦ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼**: `FRONT_LENGTH`, `BACK_LENGTH`, `CHEST_GIRTH_FINISHED`ãªã©

#### `Docs/MeasurementMaster v1.md`
- **å½¹å‰²**: äººä½“æ¡å¯¸é …ç›®è¾æ›¸
- **å†…å®¹**: FreeSewingã«æ¸¡ã™`measurements`ã®å®šç¾©
- **ä¸»è¦æ¸¬å®šå€¤**: `STATURE`, `CHEST`, `WAIST`, `HIPS`ãªã©

#### `.md/00_system-design.md`
- **å½¹å‰²**: ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆå›³
- **å†…å®¹**: ãƒ‰ãƒ¡ã‚¤ãƒ³æ¦‚å¿µã®æ•´ç†ã€ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ

#### `.md/FSProtover.md`
- **å½¹å‰²**: FreeSewingãƒãƒ¼ã‚¸ãƒ§ãƒ³æ–¹é‡
- **å†…å®¹**: ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã¨ã‚¢ãƒ€ãƒ—ã‚¿å±¤ã®åˆ†é›¢æ–¹é‡ã€v3.x APIä½¿ç”¨ã®æ–¹é‡

---

### ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ï¼ˆ`src/domain/`ï¼‰

#### `types.ts`
- **å½¹å‰²**: ãƒ‰ãƒ¡ã‚¤ãƒ³å‹å®šç¾©ï¼ˆFreeSewingéä¾å­˜ï¼‰
- **ä¸»è¦å‹**: `BodyRow`, `BodyShapeRow`, `PatternCoreRow`, `MeasurementProfile`ãªã©

#### `measurementBuilder.ts`
- **å½¹å‰²**: MeasurementProfileæ§‹ç¯‰
- **æ©Ÿèƒ½**: BodyMaster + BodyShapeMaster â†’ MeasurementProfile
- **é–¢æ•°**: `buildMeasurementProfile()`

#### `sampleMeta.ts`
- **å½¹å‰²**: SampleMetaç”Ÿæˆ
- **æ©Ÿèƒ½**: MeasurementProfile + SVGæƒ…å ± â†’ SampleMeta JSON
- **é–¢æ•°**: `createSampleMeta()`

---

### ã‚¢ãƒ€ãƒ—ã‚¿å±¤ï¼ˆ`src/freesewing/`ï¼‰

#### `draftSimon.ts`
- **å½¹å‰²**: Simonãƒ‘ã‚¿ãƒ¼ãƒ³ç”Ÿæˆï¼ˆæ¨™æº–ï¼‰
- **æ©Ÿèƒ½**: MeasurementProfile â†’ FreeSewing Simon â†’ SVG + Meta JSON
- **å®Ÿè¡Œ**: `npm run draft:simon`

#### `draftSimonNekose.ts`
- **å½¹å‰²**: Simonãƒ‘ã‚¿ãƒ¼ãƒ³ç”Ÿæˆï¼ˆçŒ«èƒŒè£œæ­£ï¼‰
- **æ©Ÿèƒ½**: `shape_id: "SHAPE_NEKOSE"`ã§ç”Ÿæˆ
- **å®Ÿè¡Œ**: `npm run draft:simon:nekose`

#### `draftSimonGrid.ts`
- **å½¹å‰²**: Simonãƒ‘ã‚¿ãƒ¼ãƒ³ç”Ÿæˆï¼ˆã‚°ãƒªãƒƒãƒ‰ï¼‰
- **æ©Ÿèƒ½**: è¤‡æ•°ã®body_id Ã— shape_idã®çµ„ã¿åˆã‚ã›ã§ä¸€æ‹¬ç”Ÿæˆ

#### `generateSimonGrid.ts`
- **å½¹å‰²**: ã‚°ãƒªãƒƒãƒ‰ç”Ÿæˆãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
- **æ©Ÿèƒ½**: ãƒãƒƒãƒå‡¦ç†ã®ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°

---

### ãƒ„ãƒ¼ãƒ«å±¤ï¼ˆ`src/tools/`ï¼‰

#### `extractFromSvg.ts`
- **å½¹å‰²**: SVGã‹ã‚‰ã®ç‰¹å¾´é‡æŠ½å‡º
- **æ©Ÿèƒ½**: SVGãƒ‘ã‚¹ã‹ã‚‰`garment_measures`ã‚’è¨ˆç®—

#### `introspectSvg.ts`
- **å½¹å‰²**: SVGæ§‹é€ è§£æ
- **æ©Ÿèƒ½**: SVGãƒ•ã‚¡ã‚¤ãƒ«ã®æ§‹é€ ã‚’è§£æãƒ»è¡¨ç¤º

---

### å‡ºåŠ›å±¤ï¼ˆ`output/`ï¼‰

#### `*.svg`
- **å½¹å‰²**: ç”Ÿæˆã•ã‚ŒãŸå‹ç´™SVGãƒ•ã‚¡ã‚¤ãƒ«
- **å‘½åè¦å‰‡**: `{fs_pattern_id}_{body_id}_{shape_id}_{version}.svg`
- **ä¾‹**: `simon_BODY_MEN_20_MID_JIS_M_NOSHAPE_v1.svg`

#### `*.meta.json`
- **å½¹å‰²**: ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆSampleMetaå½¢å¼ï¼‰
- **å‘½åè¦å‰‡**: `{fs_pattern_id}_{body_id}_{shape_id}_{version}.meta.json`
- **å†…å®¹**: `core`, `geometry`, `measurement_profile`, `features`ãªã©

---

## è¨­è¨ˆåŸå‰‡

### 1. ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã¨ã‚¢ãƒ€ãƒ—ã‚¿å±¤ã®åˆ†é›¢
- **ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤** (`src/domain/`): FreeSewingéä¾å­˜ã®è¨­è¨ˆ
- **ã‚¢ãƒ€ãƒ—ã‚¿å±¤** (`src/freesewing/`): FreeSewingä¾å­˜ã‚’é›†ç´„
- **ç›®çš„**: FreeSewingã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³å¤‰æ›´ã«å¼·ã„è¨­è¨ˆ

### 2. ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿é§†å‹•
- **BodyMaster**: ä½“å‹ãƒ‡ãƒ¼ã‚¿ã®ä¸€å…ƒç®¡ç†
- **BodyShapeMaster**: éª¨æ ¼è£œæ­£ã®ä¸€å…ƒç®¡ç†
- **PatternMaster**: ãƒ‘ã‚¿ãƒ¼ãƒ³æƒ…å ±ã®ä¸€å…ƒç®¡ç†
- **ç›®çš„**: ãƒ‡ãƒ¼ã‚¿ã®æ‹¡å¼µæ€§ã¨ä¿å®ˆæ€§

### 3. ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã®æ§‹é€ åŒ–
- **SampleMeta**: ç”Ÿæˆã•ã‚ŒãŸå‹ç´™ã®å®Œå…¨ãªãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿
- **FeatureMaster**: ç‰¹å¾´é‡ã®è¾æ›¸å®šç¾©
- **MeasurementMaster**: æ¸¬å®šå€¤ã®è¾æ›¸å®šç¾©
- **ç›®çš„**: å­¦ç¿’ç”¨ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦ã®å“è³ªä¿è¨¼

---

## ç¾åœ¨ã®å®Ÿè£…çŠ¶æ³

### å®Ÿè£…æ¸ˆã¿
- âœ… Simonãƒ‘ã‚¿ãƒ¼ãƒ³ã®å˜ä¸€ç”Ÿæˆï¼ˆæ¨™æº–ãƒ»çŒ«èƒŒè£œæ­£ï¼‰
- âœ… MeasurementProfileæ§‹ç¯‰
- âœ… SampleMetaç”Ÿæˆ
- âœ… ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ãƒ»æ¤œè¨¼

### å®Ÿè£…ä¸­ãƒ»äºˆå®š
- ğŸ”„ ã‚°ãƒªãƒƒãƒ‰ç”Ÿæˆï¼ˆè¤‡æ•°body_id Ã— shape_idï¼‰
- ğŸ”„ SVGã‹ã‚‰ã®ç‰¹å¾´é‡æŠ½å‡º
- ğŸ”„ ãƒ‘ã‚¿ãƒ¼ãƒ³æ±ç”¨åŒ–ï¼ˆSimonä»¥å¤–ã¸ã®å¯¾å¿œï¼‰

---

## ä¾å­˜é–¢ä¿‚

### ä¸»è¦ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸
- `@freesewing/simon`: FreeSewing Simonãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆv3.xï¼‰
- `typescript`: TypeScriptã‚³ãƒ³ãƒ‘ã‚¤ãƒ©
- `@types/node`: Node.jså‹å®šç¾©

### é–‹ç™ºä¾å­˜
- `ts-node`: TypeScriptç›´æ¥å®Ÿè¡Œ

---

## å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰

```bash
# ãƒ“ãƒ«ãƒ‰
npm run build

# Simonãƒ‘ã‚¿ãƒ¼ãƒ³ç”Ÿæˆï¼ˆæ¨™æº–ï¼‰
npm run draft:simon

# Simonãƒ‘ã‚¿ãƒ¼ãƒ³ç”Ÿæˆï¼ˆçŒ«èƒŒè£œæ­£ï¼‰
npm run draft:simon:nekose

# ä¸¡æ–¹ç”Ÿæˆ
npm run draft:simon:both
```

---

**æœ€çµ‚æ›´æ–°**: 2025-11-11  
**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒãƒ¼ã‚¸ãƒ§ãƒ³**: pipeline.v1

